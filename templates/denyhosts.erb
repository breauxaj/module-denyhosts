# MANAGED BY PUPPET!

       ############ THESE SETTINGS ARE REQUIRED ############

<% if secure_log and ! secure_log.empty? -%>
SECURE_LOG = <%= secure_log %>
<% else -%>
SECURE_LOG = /var/log/secure
<% end -%>

<% if hosts_deny and ! hosts_deny.empty? -%>
HOSTS_DENY = <%= hosts_deny %>
<% else -%>
HOSTS_DENY = /etc/hosts.deny
<% end -%>

<% if purge_deny and ! purge_deny.empty? -%>
PURGE_DENY = <%= purge_deny %>
<% else -%>
PURGE_DENY = 4w
<% end -%>
<% if purge_threshold and ! purge_threshold.empty? -%>
PURGE_THRESHOLD = <%= purge_threshold %>
<% end -%>

<% if block_service and ! block_service.empty? -%>
BLOCK_SERVICE = <%= block_service %>
<% else -%>
BLOCK_SERVICE  = sshd
<% end -%>

<% if deny_threshold_invalid and ! deny_threshold_invalid.empty? -%>
DENY_THRESHOLD_INVALID = <%= deny_threshold_invalid %>
<% else -%>
DENY_THRESHOLD_INVALID = 5
<% end -%>
<% if deny_threshold_valid and ! deny_threshold_valid.empty? -%>
DENY_THRESHOLD_VALID = <%= deny_threshold_valid %>
<% else -%>
DENY_THRESHOLD_VALID = 10
<% end -%>
<% if deny_threshold_root and ! deny_threshold_root.empty? -%>
DENY_THRESHOLD_ROOT = <%= deny_threshold_root %>
<% else -%>
DENY_THRESHOLD_ROOT = 1
<% end -%>
<% if deny_threshold_restricted and ! deny_threshold_restricted.empty? -%>
DENY_THRESHOLD_RESTRICTED = <%= deny_threshold_restricted %>
<% else -%>
DENY_THRESHOLD_RESTRICTED = 1
<% end -%>

<% if work_dir and ! work_dir.empty? -%>
WORK_DIR = <%= work_dir %>
<% else -%>
WORK_DIR = /var/lib/denyhosts
<% end -%>

<% if suspicious_login_report_allowed_hosts and ! suspicious_login_report_allowed_hosts.empty? -%>
SUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS = <%= suspicious_login_report_allowed_hosts.upcase %>
<% else -%>
SUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS = YES
<% end -%>

<% if hostname_lookup and ! hostname_lookup.empty? -%>
HOSTNAME_LOOKUP = <%= hostname_lookup.upcase %>
<% else -%>
HOSTNAME_LOOKUP=YES
<% end -%>

<% if lock_file and ! lock_file.empty? -%>
LOCK_FILE = <%= lock_file %>
<% else -%>
LOCK_FILE = /var/lock/subsys/denyhosts
<% end -%>

       ############ THESE SETTINGS ARE OPTIONAL ############

<% if admin_email and ! admin_email.empty? -%>
ADMIN_EMAIL = <%= admin_email %>
<% else -%>
ADMIN_EMAIL = root
<% end -%>

<% if smtp_host and ! smtp_host.empty? -%>
SMTP_HOST = <%= smtp_host %>
<% else -%>
SMTP_HOST = localhost
<% end -%>
<% if smtp_port and ! smtp_port.empty? -%>
SMTP_PORT = <%= smtp_port %>
<% else -%>
SMTP_PORT = 25
<% end -%>
<% if smtp_username and ! smtp_username.empty? -%>
SMTP_USERNAME = <%= smtp_username %>
<% end -%>
<% if smtp_password and ! smtp_password.empty? -%>
SMTP_PASSWORD = <%= smtp_password %>
<% end -%>
<% if smtp_from and ! smtp_from.empty? -%>
SMTP_FROM = <%= smtp_from %>
<% else -%>
SMTP_FROM = DenyHosts <nobody@localhost>
<% end -%>
<% if smtp_subject and ! smtp_subject.empty? -%>
SMTP_SUBJECT = <%= smtp_subject %>
<% else -%>
SMTP_SUBJECT = DenyHosts Report from $[HOSTNAME]
<% end -%>
<% if smtp_date_format and ! smtp_date_format.empty? -%>
SMTP_DATE_FORMAT = <%= smtp_date_format %>
<% end -%>

<% if syslog_report and ! syslog_report.empty? -%>
SYSLOG_REPORT = <%= syslog_report.upcase %>
<% end -%>

<% if allowed_hosts_hostname_lookup and ! allowed_hosts_hostname_lookup.empty? -%>
ALLOWED_HOSTS_HOSTNAME_LOOKUP = <%= allowed_hosts_hostname_lookup.upcase %>
<% end -%>

<% if age_reset_valid and ! age_reset_valid.empty? -%>
AGE_RESET_VALID = <%= age_reset_valid %>
<% else -%>
AGE_RESET_VALID=5d
<% end -%>
<% if age_reset_root and ! age_reset_root.empty? -%>
AGE_RESET_ROOT = <%= age_reset_root %>
<% else -%>
AGE_RESET_ROOT=25d
<% end -%>
<% if age_reset_restricted and ! age_reset_restricted.empty? -%>
AGE_RESET_RESTRICTED = <%= age_reset_restricted %>
<% else -%>
AGE_RESET_RESTRICTED=25d
<% end -%>
<% if age_reset_invalid and ! age_reset_invalid.empty? -%>
AGE_RESET_INVALID = <%= age_reset_invalid %>
<% else -%>
AGE_RESET_INVALID=10d
<% end -%>

<% if reset_on_success and ! reset_on_success.empty? -%>
RESET_ON_SUCCESS = <%= reset_on_success.upcase %>
<% end -%>

<% if plugin_deny and ! plugin_deny.empty? -%>
PLUGIN_DENY = <%= plugin_deny %>
<% end -%>
<% if plugin_purge and ! plugin_purge.empty? -%>
PLUGIN_PURGE = <%= plugin_purge %>
<% end -%>

<% if userdef_failed_entry_regex and ! userdef_failed_entry_regex.empty? -%>
<% userdef_failed_entry_regex.each do |ufer| -%>
USERDEF_FAILED_ENTRY_REGEX = <%= ufer %>
<% end -%>
<% end -%>

   ######### THESE SETTINGS ARE SPECIFIC TO DAEMON MODE  ##########

<% if daemon_log and ! daemon_log.empty? -%>
DAEMON_LOG = <%= daemon_log %>
<% else -%>
DAEMON_LOG = /var/log/denyhosts
<% end -%>
<% if daemon_log_time_format and ! daemon_log_time_format.empty? -%>  
DAEMON_LOG_TIME_FORMAT = <%= daemon_log_time_format %>
<% end -%>
<% if daemon_log_message_format and ! daemon_log_message_format.empty? -%>
DAEMON_LOG_MESSAGE_FORMAT = <%= daemon_log_message_format %>
<% end -%>

<% if daemon_sleep and ! daemon_sleep.empty? -%>
DAEMON_SLEEP = <%= daemon_sleep %>
<% else -%>
DAEMON_SLEEP = 30s
<% end -%>
<% if daemon_purge and ! daemon_purge.emtpy? -%>
DAEMON_PURGE = <%= daemon_purge -%>
<% else -%>
DAEMON_PURGE = 1h
<% end -%>
