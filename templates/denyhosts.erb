# MANAGED BY PUPPET!

       ############ THESE SETTINGS ARE REQUIRED ############

<% if secure_log and ! secure_log.empty? -%>
SECURE_LOG = <%= secure_log %>
<% else -%>
SECURE_LOG = /var/log/secure
<% end -%>

<% if hosts_deny and ! hosts_deny.empty? -%>
HOSTS_DENY = <%= hosts_deny %>
<% else -%>
HOSTS_DENY = /etc/hosts.deny
<% end -%>

<% if purge_deny and ! purge_deny.empty? -%>
PURGE_DENY = <%= purge_deny %>
<% else -%>
PURGE_DENY = 4w
<% end -%>
<% if purge_threshold and ! purge_threshold.empty? -%>
PURGE_THRESHOLD = <%= purge_threshold %>
<% end -%>

<% if block_service and ! block_service.empty? -%>
BLOCK_SERVICE = <%= block_service %>
<% else -%>
BLOCK_SERVICE  = sshd
<% end -%>

<% if deny_threshold_invalid and ! deny_threshold_invalid.empty? -%>
DENY_THRESHOLD_INVALID = <%= deny_threshold_invalid %>
<% else -%>
DENY_THRESHOLD_INVALID = 5
<% end -%>
<% if deny_threshold_valid and ! deny_threshold_valid.empty? -%>
DENY_THRESHOLD_VALID = <%= deny_threshold_valid %>
<% else -%>
DENY_THRESHOLD_VALID = 10
<% end -%>
<% if deny_threshold_root and ! deny_threshold_root.empty? -%>
DENY_THRESHOLD_ROOT = <%= deny_threshold_root %>
<% else -%>
DENY_THRESHOLD_ROOT = 1
<% end -%>
<% if deny_threshold_restricted and ! deny_threshold_restricted.empty? -%>
DENY_THRESHOLD_RESTRICTED = <%= deny_threshold_restricted %>
<% else -%>
DENY_THRESHOLD_RESTRICTED = 1
<% end -%>

<% if work_dir and ! work_dir.empty? -%>
WORK_DIR = <%= work_dir %>
<% else -%>
WORK_DIR = /var/lib/denyhosts
<% end -%>

<% if suspicious_login_report_allowed_hosts and ! suspicious_login_report_allowed_hosts.empty? -%>
SUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS = <%= suspicious_login_report_allowed_hosts.upcase %>
<% else -%>
SUSPICIOUS_LOGIN_REPORT_ALLOWED_HOSTS = YES
<% end -%>

<% if hostname_lookup and ! hostname_lookup.empty? -%>
HOSTNAME_LOOKUP = <%= hostname_lookup.upcase %>
<% else -%>
HOSTNAME_LOOKUP=YES
<% end -%>

<% if lock_file and ! lock_file.empty? -%>
LOCK_FILE = <%= lock_file %>
<% else -%>
LOCK_FILE = /var/lock/subsys/denyhosts
<% end -%>

       ############ THESE SETTINGS ARE OPTIONAL ############

<% if admin_email and ! admin_email.empty? -%>
ADMIN_EMAIL = <%= admin_email %>
<% else -%>
ADMIN_EMAIL = root
<% end -%>

<% if smtp_host and ! smtp_host.empty? -%>
SMTP_HOST = <%= smtp_host %>
<% else -%>
SMTP_HOST = localhost
<% end -%>
<% if smtp_port and ! smtp_port.empty? -%>
SMTP_PORT = <%= smtp_port %>
<% else -%>
SMTP_PORT = 25
<% end -%>
<% if smtp_username and ! smtp_username.empty? -%>
SMTP_USERNAME = <%= smtp_username %>
<% end -%>
<% if smtp_password and ! smtp_password.empty? -%>
SMTP_PASSWORD = <%= smtp_password %>
<% end -%>
<% if smtp_from and ! smtp_from.empty? -%>
SMTP_FROM = <%= smtp_from %>
<% else -%>
SMTP_FROM = DenyHosts <nobody@localhost>
<% end -%>
<% if smtp_subject and ! smtp_subject.empty? -%>
SMTP_SUBJECT = <%= smtp_subject %>
<% else -%>
SMTP_SUBJECT = DenyHosts Report from $[HOSTNAME]
<% end -%>
<% if smtp_date_format and ! smtp_date_format.empty? -%>
SMTP_DATE_FORMAT = <%= smtp_date_format %>
<% end -%>

<% if syslog_report and ! syslog_report.empty? -%>
SYSLOG_REPORT = <%= syslog_report.upcase %>
<% end -%>

<% if allowed_hosts_hostname_lookup and ! allowed_hosts_hostname_lookup.empty? -%>
ALLOWED_HOSTS_HOSTNAME_LOOKUP = <%= allowed_hosts_hostname_lookup.upcase %>
<% end -%>

<% if age_reset_valid and ! age_reset_valid.empty? -%>
AGE_RESET_VALID = <%= age_reset_valid %>
<% else -%>
AGE_RESET_VALID=5d
<% end -%>
<% if age_reset_root and ! age_reset_root.empty? -%>
AGE_RESET_ROOT = <%= age_reset_root %>
<% else -%>
AGE_RESET_ROOT=25d
<% end -%>
<% if age_reset_restricted and ! age_reset_restricted.empty? -%>
AGE_RESET_RESTRICTED = <%= age_reset_restricted %>
<% else -%>
AGE_RESET_RESTRICTED=25d
<% end -%>
<% if age_reset_invalid and ! age_reset_invalid.empty? -%>
AGE_RESET_INVALID = <%= age_reset_invalid %>
<% else -%>
AGE_RESET_INVALID=10d
<% end -%>

<% if reset_on_success and ! reset_on_success.empty? -%>
RESET_ON_SUCCESS = <%= reset_on_success.upcase %>
<% end -%>




#
#####################################################################


######################################################################
#
# PLUGIN_DENY: If set, this value should point to an executable
# program that will be invoked when a host is added to the
# HOSTS_DENY file.  This executable will be passed the host
# that will be added as it's only argument.
#
#PLUGIN_DENY=/usr/bin/true
#
######################################################################


######################################################################
#
# PLUGIN_PURGE: If set, this value should point to an executable
# program that will be invoked when a host is removed from the
# HOSTS_DENY file.  This executable will be passed the host
# that is to be purged as it's only argument.
#
#PLUGIN_PURGE=/usr/bin/true
#
# The following plugin will restore the file contexts on /etc/hosts.deny after
# denyhosts purges old entries.  This prevents breakage when selinux is set to
# enforcing mode, but still has a small window where the context is set
# incorrectly.  The correct place to fix this is in the selinux policy.
#
#PLUGIN_PURGE=/usr/share/denyhosts/plugins/restorecon.sh
#
######################################################################

######################################################################
#
# USERDEF_FAILED_ENTRY_REGEX: if set, this value should contain
# a regular expression that can be used to identify additional
# hackers for your particular ssh configuration.  This functionality
# extends the built-in regular expressions that DenyHosts uses.
# This parameter can be specified multiple times.
# See this faq entry for more details:
#    http://denyhosts.sf.net/faq.html#userdef_regex
#
#USERDEF_FAILED_ENTRY_REGEX=
#
#
######################################################################




   ######### THESE SETTINGS ARE SPECIFIC TO DAEMON MODE  ##########



#######################################################################
#
# DAEMON_LOG: when DenyHosts is run in daemon mode (--daemon flag)
# this is the logfile that DenyHosts uses to report it's status.
# To disable logging, leave blank.  (default is: /var/log/denyhosts)
#
DAEMON_LOG = /var/log/denyhosts
#
# disable logging:
#DAEMON_LOG = 
#
######################################################################

#######################################################################
# 
# DAEMON_LOG_TIME_FORMAT: when DenyHosts is run in daemon mode 
# (--daemon flag) this specifies the timestamp format of 
# the DAEMON_LOG messages (default is the ISO8061 format:
# ie. 2005-07-22 10:38:01,745)
#
# for possible values for this parameter refer to: man strftime
#
# Jan 1 13:05:59   
#DAEMON_LOG_TIME_FORMAT = %b %d %H:%M:%S
#
# Jan 1 01:05:59 
#DAEMON_LOG_TIME_FORMAT = %b %d %I:%M:%S
#
###################################################################### 

#######################################################################
# 
# DAEMON_LOG_MESSAGE_FORMAT: when DenyHosts is run in daemon mode 
# (--daemon flag) this specifies the message format of each logged
# entry.  By default the following format is used:
#
# %(asctime)s - %(name)-12s: %(levelname)-8s %(message)s
#
# Where the "%(asctime)s" portion is expanded to the format
# defined by DAEMON_LOG_TIME_FORMAT
#
# This string is passed to python's logging.Formatter contstuctor.
# For details on the possible format types please refer to:
# http://docs.python.org/lib/node357.html
#
# This is the default:
#DAEMON_LOG_MESSAGE_FORMAT = %(asctime)s - %(name)-12s: %(levelname)-8s %(message)s
#
#
###################################################################### 

 
#######################################################################
#
# DAEMON_SLEEP: when DenyHosts is run in daemon mode (--daemon flag)
# this is the amount of time DenyHosts will sleep between polling
# the SECURE_LOG.  See the comments in the PURGE_DENY section (above)
# for details on specifying this value or for complete details
# refer to:    http://denyhosts.sourceforge.net/faq.html#timespec
# 
#
DAEMON_SLEEP = 30s
#
#######################################################################

#######################################################################
#
# DAEMON_PURGE: How often should DenyHosts, when run in daemon mode,
# run the purge mechanism to expire old entries in HOSTS_DENY
# This has no effect if PURGE_DENY is blank.
#
DAEMON_PURGE = 1h
#
#######################################################################
